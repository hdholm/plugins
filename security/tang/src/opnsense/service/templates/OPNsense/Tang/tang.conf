{% from 'OPNsense/Macros/interface.macro' import physical_interface %}
##
## OPNsense autogenerated config file.
## Don't change it because your changes get lost.
##
##
{% if helpers.exists('OPNsense.tang.general.enabled') and OPNsense.tang.general.enabled == '1' %}
tangd_enable="YES"
tangd_port={{ OPNsense.tang.general.port|default("8888") }}
{%   if helpers.exists('OPNsense.tang.general.interface') and OPNsense.tang.general.interface != '' %}
{%     if helpers.exists('interfaces.'+OPNsense.tang.general.interface+'.ipaddr') %}
{%       set interface_ip = helpers.getNodeByTag('interfaces.'+OPNsense.tang.general.interface+'.ipaddr') %}
{%       if '.' in interface_ip %}
{%         set ip4 = interface_ip %}
{%       endif %}
{%     endif %}
{%     if helpers.exists('interfaces.'+OPNsense.tang.general.interface+'.ipaddrv6') %}
{%       set interface_ip = helpers.getNodeByTag('interfaces.'+OPNsense.tang.general.interface+'.ipaddrv6') %}
{%       if ':' in interface_ip %}
{%         set ip6 = interface_ip %}
{%       endif %}
{%     endif %}
{%   endif %}
tangd_ip4="{{ ip4|default("127.0.0.1") }}"
tangd_ip6="{{ ip6|default("::1") }}"
tangd_jwkdir={{ OPNsense.tang.general.jwkdir|default("/var/db/tang") }}
tandg_logfile={{ OPNsense.tang.general.log|default("/var/log/tang") }}
tangd_executable={{ OPNsense.tang.general.executable|default("/usr/local/libexec/tangd") }}
{% else %}
tangd_enable="NO"
{% endif %}
